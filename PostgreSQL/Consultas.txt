crosstab
https://ed.team/blog/consultas-avanzadas-en-postgres-con-tablas-de-referencia-cruzada-pivot-table
https://dbfiddle.uk/?rdbms=postgres_10&fiddle=83cf8c556b1932c8d933d7e5e0ed10de